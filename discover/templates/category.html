
{% extends 'base.html' %}
{% block content %}
<link rel="stylesheet" media="screen" href="/static/vendor/simplebar/dist/simplebar.min.css"/>
<link rel="stylesheet" media="screen" href="/static/vendor/tiny-slider/dist/tiny-slider.css"/>
<link rel="stylesheet" media="screen" href="/static/vendor/nouislider/distribute/nouislider.min.css"/>
<link rel="stylesheet" media="screen" href="/static/vendor/drift-zoom/dist/drift-basic.min.css"/>

<!-- Page Title-->
<div class="page-title-overlap bg-dark pt-4">
  <div class="container d-lg-flex justify-content-between py-2 py-lg-3">
    <div class="order-lg-2 mb-3 mb-lg-0 pt-lg-2">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb breadcrumb-light flex-lg-nowrap justify-content-center justify-content-lg-start">
          <li class="breadcrumb-item"><a class="text-nowrap" href="index.html"><i class="ci-home"></i>Home</a></li>
          <li class="breadcrumb-item text-nowrap active" aria-current="page">Discover</li>
        </ol>
      </nav>
    </div>
    <div class="order-lg-1 pe-lg-4 text-center text-lg-start">
      <h1 class="h3 text-light mb-0">DISCOVER OUR PRODUCTS</h1>
    </div>
  </div>
</div>
<div class="container pb-5 mb-2 mb-md-4">
  <div class="row">
    <!-- Sidebar-->
    <aside class="col-lg-4">
      <!-- Sidebar-->
      <div class="offcanvas offcanvas-collapse bg-white w-100 rounded-3 shadow-lg py-1" id="shop-sidebar" style="max-width: 22rem;">
        <div class="offcanvas-cap align-items-center shadow-sm">
          <h2 class="h5 mb-0">Filters</h2>
          <button class="btn-close ms-auto" type="button" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body py-grid-gutter px-lg-grid-gutter">
          <!-- Categories-->
          <div class="widget widget-categories mb-4 pb-4 border-bottom">
            <h3 class="widget-title btn btn-primary d-block w-100">Categories</h3>
            
              <div >
                <h6 ><a class= "btn btn-light border-primary w-100" w-100 href="{% url 'discover:discover_page' %}" > All Products</a></h6>
              </div>
           
              {%for category in categories %}
              <div  id="shop-categories">
                <div >
                  <h6 ><a class= "btn btn-light border-primary w-100" href="{% url 'discover:category' category.slug %}" role="button">{{category|title}}</a></h6>
                </div>
              </div>
              {%endfor%}
          </div>
          <!-- Price range-->
          <div class="widget widget-categories mb-4 pb-4 border-bottom">
          <form method="get" action="{% url 'discover:discover_page' %}">
          <div class="column is-4">
            <h3 class="widget-title btn btn-primary d-block w-100">Price range</h3>
            <div class="field">
                <label>From</label>
                <div class="control">
                    <input class="form-control" type="number" name="price_from" class="input" value="{{ price_from }}">
                </div>
            </div>

            <div class="field">
                <label>To</label>
                <div class="control">
                    <input class="form-control" type="number" name="price_to" class="input" value="{{ price_to }}">
                </div>
            </div>
          </div>
          </div>
          <div>
            <div class="column is-12">
              <div class="field">
                  <div class="control">
                      <button class="is-success btn btn-primary d-block w-100">Search</button>
                  </div>
              </div>
          </div>
          </div>
          
          </form>
        </div>
      </div>
    </aside>
    <!-- Content  -->
    <section class="col-lg-8">
      <!-- Toolbar-->
      <div class="d-flex justify-content-center justify-content-sm-between align-items-center pt-2 pb-4 pb-sm-5">
        <div class="d-flex flex-wrap">
          <div class="d-flex align-items-center flex-nowrap me-3 me-sm-4 pb-3">
            <label class="text-light opacity-75 text-nowrap fs-sm me-2 d-none d-sm-block" for="sorting">Sort by:</label>
            <select class="form-select" id="sorting">
              <option>Popularity</option>
              <option>Low - Hight Price</option>
              <option>High - Low Price</option>
              <option>Average Rating</option>
              <option>A - Z Order</option>
              <option>Z - A Order</option>
            </select><span class="fs-sm text-light opacity-75 text-nowrap ms-2 d-none d-md-block">of 287 products</span>
          </div>
        </div>
        <div class="d-flex pb-3"><a class="nav-link-style nav-link-light me-3" href="#"><i class="ci-arrow-left"></i></a><span class="fs-md text-light">1 / 5</span><a class="nav-link-style nav-link-light ms-3" href="#"><i class="ci-arrow-right"></i></a></div>
        <div class="d-none d-sm-flex pb-3"><a class="btn btn-icon nav-link-style bg-light text-dark disabled opacity-100 me-2" href="#"><i class="ci-view-grid"></i></a><a class="btn btn-icon nav-link-style nav-link-light" href="shop-list-ls.html"><i class="ci-view-list"></i></a></div>
      </div>
      <!-- Products grid-->
      <div class="row mx-n2">
        <h3>All {{category.title}} Category Products </h3>
        <div class="row">
            {% for p in category_products %}
            <div class="col-md-4 col-sm-6 px-2 mb-4">
              <div class="card product-card">
                <button class="btn-wishlist btn-sm" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Add to wishlist"><i class="ci-heart"></i></button><a class="card-img-top d-block overflow-hidden" href="shop-single-v1.html"><img src="{{p.image.url}}" alt="Product"></a>
                
                <div class="card-body py-2">
                  <h3 class="product-title fs-sm"><a href="shop-single-v1.html">{{p.name}}</a></h3>
                <div class="product-price"><span class="text-accent">{{p.price}} TND </div>
                  <a class="product-meta d-block fs-xs pb-1" href="#">from {{p.category}} category</a>
                  <a class="product-meta d-block fs-xs pb-1" href="#">By {{p.store}}</a>
                  <div class="d-flex justify-content-between">
                      <div class="star-rating"><div class="rating-star">
                        <span>
                          <i class="fa fa-star{% if p.averageReview < 0.5 %}-o{% elif p.averageReview >= 0.5 and p.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                          <i class="fa fa-star{% if p.averageReview < 1.5 %}-o{% elif p.averageReview >= 1.5 and p.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                          <i class="fa fa-star{% if p.averageReview < 2.5 %}-o{% elif p.averageReview >= 2.5 and p.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                          <i class="fa fa-star{% if p.averageReview < 3.5 %}-o{% elif p.averageReview >= 3.5 and p.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                          <i class="fa fa-star{% if p.averageReview < 4.5 %}-o{% elif p.averageReview >= 4.5 and p.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
                          </span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-body card-body-hidden">
                  
                  <div class="text-center"><a class="nav-link-style fs-ms" href="{% url 'discover:product_detail' p.category.slug p.slug %}" data-bs-toggle="modal"><i class="ci-eye align-middle me-1"></i>Quick view</a></div>
                </div>
              </div>
              <hr class="d-sm-none">
            </div>
            {% endfor %}
        </div>
      </div>

      </div>
      <hr class="my-3">
      <!-- Pagination-->
      <div class="row" >
        <div class="col-md-12">
          {% if discover_products.has_other_pages %}
            <ul class="pagination justify-content-center">
              {% if discover_products.has_previous %}
                <li class="page-item">
                  <a href="?page={{discover_products.previous_page_number}}" class="page-link">&laquo;</a>
                </li>
              {% else %}
                <li class="page-item disabled">
                  <a class="page-link">&laquo;</a>
                </li>
              {% endif %}
              {% for i in discover_products.paginator.page_range %}
                {% if discover_products.number == i %}
                  <li class="page-item active">
                    <a class="page-link">{{i}}</a>
                  </li>
                {% else %}
                  <li class="page-item">
                    <a href="?page={{i}}" class="page-link">{{i}}</a>
                  </li>
                {% endif %}
              {% endfor %}
              {% if discover_products.has_next %}
                <li class="page-item">
                  <a href="?page={{discover_products.next_page_number}}" class="page-link">&raquo;</a>
                </li>
              {% else %}
                <li class="page-item disabled">
                  <a class="page-link">&raquo;</a>
                </li>
              {% endif %}
            </ul>
          {% endif %}
        </div>
      </div>
    </section>
  </div>
</div>

<script src="/static/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/vendor/simplebar/dist/simplebar.min.js"></script>
<script src="/static/vendor/tiny-slider/dist/min/tiny-slider.js"></script>
<script src="/static/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script src="/static/vendor/nouislider/distribute/nouislider.min.js"></script>
<script src="/static/vendor/drift-zoom/dist/Drift.min.js"></script>

{% endblock %}

